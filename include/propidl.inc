ifndef __propidl_h__
define __propidl_h__
ifndef __propidlbase_h__
include propidlbase.inc
endif
ifndef _COML2API_H_
include coml2api.inc
endif

if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP or WINAPI_PARTITION_SYSTEM)

define PIDDI_THUMBNAIL		0x00000002

define PIDSI_TITLE		0x00000002
define PIDSI_SUBJECT		0x00000003
define PIDSI_AUTHOR		0x00000004
define PIDSI_KEYWORDS		0x00000005
define PIDSI_COMMENTS		0x00000006
define PIDSI_TEMPLATE		0x00000007
define PIDSI_LASTAUTHOR		0x00000008
define PIDSI_REVNUMBER		0x00000009
define PIDSI_EDITTIME		0x0000000a
define PIDSI_LASTPRINTED	0x0000000b
define PIDSI_CREATE_DTM		0x0000000c
define PIDSI_LASTSAVE_DTM	0x0000000d
define PIDSI_PAGECOUNT		0x0000000e
define PIDSI_WORDCOUNT		0x0000000f
define PIDSI_CHARCOUNT		0x00000010
define PIDSI_THUMBNAIL		0x00000011
define PIDSI_APPNAME		0x00000012
define PIDSI_DOC_SECURITY	0x00000013

define PIDDSI_CATEGORY		0x00000002
define PIDDSI_PRESFORMAT	0x00000003
define PIDDSI_BYTECOUNT		0x00000004
define PIDDSI_LINECOUNT		0x00000005
define PIDDSI_PARCOUNT		0x00000006
define PIDDSI_SLIDECOUNT	0x00000007
define PIDDSI_NOTECOUNT		0x00000008
define PIDDSI_HIDDENCOUNT	0x00000009
define PIDDSI_MMCLIPCOUNT	0x0000000A
define PIDDSI_SCALE		0x0000000B
define PIDDSI_HEADINGPAIR	0x0000000C
define PIDDSI_DOCPARTS		0x0000000D
define PIDDSI_MANAGER		0x0000000E
define PIDDSI_COMPANY		0x0000000F
define PIDDSI_LINKSDIRTY	0x00000010

define PIDMSI_EDITOR		0x00000002
define PIDMSI_SUPPLIER		0x00000003
define PIDMSI_SOURCE		0x00000004
define PIDMSI_SEQUENCE_NO	0x00000005
define PIDMSI_PROJECT		0x00000006
define PIDMSI_STATUS		0x00000007
define PIDMSI_OWNER		0x00000008
define PIDMSI_RATING		0x00000009
define PIDMSI_PRODUCTION	0x0000000A
define PIDMSI_COPYRIGHT		0x0000000B

.enum PIDMSI_STATUS_VALUE {
    PIDMSI_STATUS_NORMAL,
    PIDMSI_STATUS_NEW,
    PIDMSI_STATUS_PRELIM,
    PIDMSI_STATUS_DRAFT,
    PIDMSI_STATUS_INPROGRESS,
    PIDMSI_STATUS_EDIT,
    PIDMSI_STATUS_REVIEW,
    PIDMSI_STATUS_PROOF,
    PIDMSI_STATUS_FINAL,
    PIDMSI_STATUS_OTHER = 0x7fff
    }

endif

.pragma comment(lib, ole32)

if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_APP or WINAPI_PARTITION_SYSTEM or WINAPI_PARTITION_GAMES)

PropVariantCopy proto WINAPI :ptr, :ptr
PropVariantClear proto WINAPI :ptr
FreePropVariantArray proto WINAPI :ULONG, :ptr

ifdef _MSC_EXTENSIONS
define _PROPVARIANTINIT_DEFINED_

PropVariantInit proto fastcall pvar:ptr {
  memset(pvar, 0, sizeof(PROPVARIANT) )
  }
endif

endif

if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP)

ifndef _SERIALIZEDPROPERTYVALUE_DEFINED_
define _SERIALIZEDPROPERTYVALUE_DEFINED_
SERIALIZEDPROPERTYVALUE struct
dwType			dd ?
rgb			db 1 dup(?)
SERIALIZEDPROPERTYVALUE ends
endif

StgConvertVariantToProperty proto WINAPI :ptr, :USHORT, :ptr, :ptr, :PROPID, :BOOLEAN, :ptr
StgConvertPropertyToVariant proto WINAPI :ptr, :USHORT, :ptr, :ptr

endif

endif
